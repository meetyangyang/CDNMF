This paper presents an integrated optimization model of production planning and scheduling for a three-stage manufacturing system;  which is composed of a forward chain of three kinds of workshops: a job shop;  a parallel flow shop consisting of parallel production lines;  and a single machine shop. As the products at the second stage are assembled from the parts produced in its upstream workshop;  a complicated production process is involved. On the basis of the analysis of the batch production;  a dynamic batch splitting and amalgamating algorithm is proposed. Then;  a heuristic algorithm based on a genetic algorithm (known as the integrated optimization algorithm) is proposed for solving the problem. 