The infrastructure resources in distributed green cloud data centers (DGCDCs) are shared by multiple heterogeneous applications to provide flexible services to global users in a high-performance and low-cost way. It is highly challenging to minimize the total cost of a DGCDC provider in a market;  where bandwidth prices of Internet service providers (ISPs);  electricity prices;  and the availability of renewable green energy all vary with geographical locations. Unlike existing studies;  this paper proposes a spatial task scheduling and resource optimization (STSRO) method to minimize the total cost of their provider by cost-effectively scheduling all arriving tasks of heterogeneous applications to meet tasks' delay-bound constraints. STSRO well exploits spatial diversity in DGCDCs. In each time slot;  the cost minimization problem for DGCDCs is formulated as a constrained optimization one and solved by the proposed simulated annealing-based bat algorithm (SBA). Trace-driven experiments demonstrate that STSRO achieves lower total cost and higher throughput than two typical scheduling methods. 