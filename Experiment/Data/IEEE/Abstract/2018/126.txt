This paper addresses the problem of process discovery from large and complex event logs. We depart from the existing literature and formulate the problem of optimal process discovery. A formal mathematical programming model is given based on a novel hierarchical structuration of the event logs. Desired properties of event trace score functions are described;  and the properties of optimal process models are proved. A combination of Monte Carlo optimization and tabu search is proposed to overcome the complexity related to the huge size of the event logs and the combinatorial solution space. Numerical results show that our approach is suitable for large event logs and that it performs better than the state-of-the-art approaches. We also demonstrate the applicability of our method on a real case study in health care. This paper illustrates the benefits of combining techniques from the operational research and the process mining fields. 