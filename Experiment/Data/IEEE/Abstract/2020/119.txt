Machines need to be individually qualified to run lots of certain families in semiconductor wafer fabrication facilities (wafer fabs). A qualification time window that lasts a couple of days is associated with each family and each tool. The time window can be reinitialized with additional qualification effort as needed and can be extended by on-time processing of qualified families. A mixed-integer linear programming formulation is proposed. The objective function takes into account the backlog costs and inventory holding costs. Moreover;  it penalizes qualifications. The optimization approach is applied in a rolling horizon setting using a wafer fab simulation model. The demand for a planning window of several periods is derived using feedback from the shop floor. The results of the simulation experiments demonstrate that an appropriate tradeoff between production objectives and performed qualifications can be achieved by an appropriate configuration of the model. 