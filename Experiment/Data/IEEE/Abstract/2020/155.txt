To better manage patient flows;  China has promoted a referral system across the country. Patients are encouraged to receive the initial diagnosis in community hospitals (CHs);  and general hospitals (GHs) manage a slot reservation process to fulfill the needs of referral patients;  who are in more severe conditions. According to the system practices;  however;  the reservation policy usually leads to either underutilized resources or unsatisfied referrals. This article aims to investigate a more effective method of allocating resources in GHs. We formulate the referral system as an appointment booking problem;  considering the notion of the patient mix and system dynamics. The decision process of the referral system is captured by a discrete-time finite-horizon Markov decision process (MDP) model under a general framework. Theoretically;  we analyze the structural properties of the MDP value functions to prove the monotonic properties of the optimal dynamic policy. The properties inspire us to design a heuristic policy called advanced referrals (ARs) policy;  which offers resources to high-priority referrals earlier than regular patients. We prove that the AR policy is asymptotically optimal with infinite capacity and demand rates. Finally;  we compare the performance of the AR policy with the optimal dynamic policy in numerical experiments;  and also show that our policy outperforms fixed-reservation and first-come-first-serve policies which are widely used in practice. 