Body Sensor Networks (BSNs) have become prominent in research and industry alike as a powerful enabler of novel applications in human-centered domains. However;  developing applications on such systems is still a cumbersome process;  due to the lack of suitable software abstractions and the difficulties in managing wearable computing application within the stringent constraints of embedded systems. In this paper;  we introduce a novel framework;  SPINE2 (Signal Processing In Node Environment);  which allows task-oriented programming on a platform-independent architecture. We demonstrate how fairly sophisticated signal-processing applications can be realized in the form of easy-to-implement embedded processes. The proposed architecture is tested experimentally and its features are illustrated through a nontrivial case study. In the last years;  several frameworks and middlewares have been conceived and made available to support high-level programming in WSNs. These provide a generic set of features that can only be used for the most common application domains. However;  it is hard to efficiently support the more specific domain of BSNs;  which requires specific capabilities. In order to fully satisfy the BSN-based requirements;  SPINE2 has been conceived as an effective and efficient tool for developing distributed signal-processing applications. Its task-oriented paradigm allows developers to specify the applications' behavior by abstracting away any low-level details concerning the platform hardware and the communication protocol. Moreover;  its platform-independent architecture enables code reusability and portability;  as well as application interoperability and platform heterogeneity. To demonstrate the effectiveness of the proposed framework and the efficiency of the runtime environment;  a BSN-based activity recognition system has been developed through SPINE2. The easiness in implementing such a complex system thanks to both the provided programming abstractions and the framework components reusability is shown;  as well as the efficiency of the whole system whose performance has been evaluated under a range of metrics. 