Simultaneous magnetic actuation and localization (SMAL) is a promising technology for accelerating and positioning the capsule in the human intestine for wireless capsule endoscopy (WCE). In this article;  we propose a novel system that uses a rotating magnetic actuator and an external sensor array to achieve closed-loop SMAL for a capsule with two embedded magnetic rings. First;  the state of the capsule is detected as “Stuck; ” “Synchronous; ” or “Missing” by studying the relationship between the theoretical actuating magnetic field and the measured total magnetic field. Then;  the undesired interference with the localization system caused by the actuator is eliminated with an integral filter-based approach. Different models are proposed to solve the pose of the capsule according to the different states of the capsule;  and the localization result is used to update the pose of the actuator to close the loop. Extensive experiments on phantoms and animal organs with different environmental conditions are carried out to validate the proposed framework. The state detection accuracy achieves 96.7%;  and the capsule can be located with an accuracy of 5.5 mm and 5.2° in position and orientation;  respectively. Experimental results show the feasibility of our proposed system and demonstrate the robustness;  accuracy;  actuation efficiency;  and closed-loop performance of the system. \n<italic xmlns:mml=\http://www.w3.org/1998/Math/MathML\ xmlns:xlink=\http://www.w3.org/1999/xlink\>