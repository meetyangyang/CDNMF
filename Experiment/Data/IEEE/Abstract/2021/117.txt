The penetration of plug-in electric vehicles (PEVs) has greatly increased over the past few years. By using vehicle-to-grid (V2G) technology;  PEVs can be used as “mobile batteries” in a microgrid. Here;  we aim to coordinate the V2G dispatch with traditional energy management in a corporate energy system (CES). To do so;  a two-stage robust optimization (RO) model is built with respect to uncertainties in the CES;  e.g.;  photovoltaic (PV) power. Particularly;  relationships between the working time schedule and PEVs are investigated and analyzed for the first time;  and a novel PEV aggregator model;  i.e.;  shift-working V2G;  is presented. The shift-working V2G model provides beneficial characteristics;  like weakened randomness and stable storage capacity. A quantitative method to evaluate the V2G capacity is then presented. An analytical solution methodology is also proposed;  which can equivalently convert the robust “min-max-min” model to a single-level mixed-integer linear programming (MILP) model. Case studies are conducted for an iron and steel company in Shanghai;  China;  with almost 40 000 PEVs. The results show that V2G integration can significantly improve the load-tracking ability of CES and help reduce the energy cost;  although the V2G cost is considered. The computational efficiency is also improved compared with the existing methods. 