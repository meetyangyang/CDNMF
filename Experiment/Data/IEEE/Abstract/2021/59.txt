In many pilot research and development (R&D) microgrid projects;  engine-based generators are employed in their power systems;  either generating electrical energy or being mixed with the heat and power technology. One of the critical tasks of such engine-based generation units is the frequency regulation in the islanded mode of modernized microgrid (MMG) operation; MMGs are microgrids equipped with advanced controls to address more emerging scenarios in smart grids. For having a stable and reliable MMG;  we need to synthesize an optimal;  robust;  primary frequency controller for the islanded mode of MMG of the future. This task is challenging because of unknown mechanical parameters;  occurrence of uncertain disturbances;  uncertainty of loads;  operating point variations;  and the appearance of engine delays;  and hence nonminimum phase dynamics. This article presents an innovative primary frequency control for the engine generators regulating the frequency of an islanded MMG in the context of smart grids. The proposed approach is based on an adaptive optimal output-feedback control algorithm using adaptive dynamic programming (ADP). The convergence of algorithms;  along with the stability analysis of the closed-loop system;  is also shown in this article. Finally;  as experimental validation;  hardware-in-the-loop (HIL) test results are provided in order to examine the effectiveness of the proposed methodology practically. \n<italic xmlns:mml=\http://www.w3.org/1998/Math/MathML\ xmlns:xlink=\http://www.w3.org/1999/xlink\>