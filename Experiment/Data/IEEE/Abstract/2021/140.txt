Edge computing is a new architecture to provide computing;  storage;  and networking resources for achieving the Internet of Things. It brings computation to the network edge in close proximity to users. However;  nodes in the edge have limited energy and resources. Completely running tasks in the edge may cause poor performance. Cloud data centers (CDCs) have rich resources for executing tasks;  but they are located in places far away from users. CDCs lead to long transmission delays and large financial costs for utilizing resources. Therefore;  it is essential to smartly offload usersâ€™ tasks between a CDC layer and an edge computing layer. This work proposes a cloud and edge computing system;  which has a terminal layer;  edge computing layer;  and CDC layer. Based on it;  this work designs a profit-maximized collaborative computation offloading and resource allocation algorithm to maximize the profit of systems and guarantee that response time limits of tasks are strictly met. In each time slot;  this work jointly considers CPU;  memory;  and bandwidth resources;  load balance of all heterogeneous nodes in the edge layer;  maximum amount of energy;  maximum number of servers;  and task queue stability in the CDC layer. Considering the abovementioned factors;  a single-objective constrained optimization problem is formulated and solved by a proposed simulated-annealing-based migrating birds optimization procedure to obtain a close-to-optimal solution. The proposed method achieves joint optimization of computation offloading between CDC and edge;  and resource allocation in CDC. Realistic data-based simulation results demonstrate that it realizes higher profit than its peers. \n<italic xmlns:mml=\http://www.w3.org/1998/Math/MathML\ xmlns:xlink=\http://www.w3.org/1999/xlink\>