This paper addresses the design of contract for reserving the capacity of a shared critical resource from the perspective of a given class of customers. The contract is composed of three parts: contracted time slots (CTSs) reserved by the service provider for the class of customers;  advance cancellation of contracted time slots;  and requests for regular time slots (RTSs). The problem of CTS cancellation and RTS assignment is formulated as an average cost Markov Decision Process in order to minimize the total cost including customer waiting times;  unused CTS;  and CTS cancellation. Structural properties of the optimal control policies are established via the discounted cost problem. A local optimization algorithm is proposed to improve a given initial contract. Numerical results show that advance CTS cancellation significantly reduces the ratio of unused CTS with slight increase of customer waiting time. 