This paper deals with a holistic approach to coordinate a fleet of automated guided vehicles (AGVs) in an industrial environment. We propose an ensemble approach based on a two layer control architecture and on an automatic algorithm for the definition of the roadmap. The roadmap is built by considering the path planning algorithm implemented on the hierarchical architecture and vice versa. In this way;  we want to manage the coordination of the whole system in order to increase the flexibility and the global efficiency. Furthermore;  the roadmap is computed in order to maximize the redundancy;  the coverage and the connectivity. The architecture is composed of two layers. The low-level represents the roadmap itself. The high-level describes the topological relationship among different areas of the environment. The path planning algorithm works on both these levels and the subsequent coordination among AGVs is obtained exploiting shared resource (i.e.;  centralized information) and local negotiation (i.e.;  decentralized coordination). The proposed approach is validated by means of simulations and comparison using real plants. 