We propose a dynamic algorithm for distributed feedback control which unifies the functions of production and maintenance scheduling at the shop floor level;  and machinery capacity control at the CNC level;  which are usually considered in isolation in practice. A continuous-time control theoretic approach is used to model dynamics of these three functions in a unified manner;  considering stochastic machine failures and a corresponding maintenance interval. Theories of nonlinear control and discontinuous differential equations are used to analytically predict the system dynamics including the resulting discontinuous dynamics. 