In this paper;  we present Overgrid;  a fully distributed peer-to-peer (P2P) architecture designed to automatically control and implement distributed demand response (DR) schemes in a community of smart buildings with energy generation and storage capabilities. As overlay networks in communications establish logical links between peers regardless of the physical topology of the network;  the Overgrid is able to apply some power balance criteria to its system of buildings;  as they belong to a virtual microgrid;  regardless of their physical location. We exploit an innovative distributed algorithm;  called flow updating;  for monitoring the power consumption of the buildings and the number of nodes in the network;  proving its applicability in an Overgrid scenario with realistic power profiles and networks of up to 10 000 buildings. To quantify the energy balance capability of Overgrid;  we first study the energy characteristics of several types of buildings in our university campus and in an industrial site to accurately provide some reference buildings models. Then;  we classify the amount of “flexible” energy consumption;  i.e.;  the quota that could be potentially exploited for DR programs. Finally;  we validate Overgrid emulating a real P2P network of smart buildings behaving according to our reference models. The experimental results prove the feasibility of our approach. 