This article presents a fault diagnosis algorithm for rotating machinery based on the Wasserstein distance. Recently;  the Wasserstein distance has been proposed as a new research direction to find better distribution mapping when compared with other popular statistical distances and divergences. In this work;  first;  frequency- and time-based features are extracted by vibration signals;  and second;  the Wasserstein distance is considered for the learning phase to discriminate the different machine operating conditions. Specifically;  the 1-D Wasserstein distance is considered due to its low computational burden because it can be evaluated directly by the order statistics of the extracted features. Furthermore;  a distance weighting stage based on neighborhood component features selection (NCFS) is exploited to achieve robust fault diagnosis at low signal-to-noise ratio (SNR) conditions and with high-dimensional features. In detail;  the NCFS framework is here adapted to weight 1-D Wasserstein distances evaluated from time/frequency features. Experiments are conducted on two benchmark data sets to verify the effectiveness of the proposed fault diagnosis method at different SNR conditions. The comparison with state-of-the-art fault diagnosis algorithms shows promising results. \n<italic xmlns:mml=\http://www.w3.org/1998/Math/MathML\ xmlns:xlink=\http://www.w3.org/1999/xlink\>