The problem under consideration in this paper is how to avoid deadlocks and livelocks in the paradigm of Petri nets (PNs). Although deadlock and livelock avoidance has been extensively studied in existing literature;  fewer results can be applied to practical automated manufacturing systems (AMSs) due to expensive computations and reduced permissiveness. In this paper;  we propose an efficient and maximally permissive control scheme to avoid deadlocks and livelocks by using critical distance. From the perspective of the reachability graph of a PN;  critical distance is equal to the maximum number of transitions among all transition sequences from any critical state to its corresponding deadlock or livelock state. First;  we show how to calculate the critical distance of a PN in an efficient way by using a portion of reachable states. Then;  local reachability graphs are established based on critical distance to avoid deadlocks and livelocks. The provided policy is maximally permissive since only the necessary minimum number of illegal transitions are forbidden at each state. Several representative examples are presented to illustrate our approach. 