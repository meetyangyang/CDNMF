Inpatient rooms are critical resources for hospitals. Against the background of aging populations and environmental problems;  the twofold predicament-involving escalating healthcare demands and insufficient room-based resources-has led to the necessity for hospitals to operate more effectively and efficiently. Capacity management and patient scheduling are thus the two most important operations for hospital management. Because of the self-financing feature of hospitals and the quasi-public nature of medical services;  it is important for public hospitals to judiciously allocate limited room capacities to multiple types of patients for balancing revenue and equity and schedule the arrival demands dynamically according to the planned capacity and acceptance ratio. In this article;  we propose mathematical models and solution approaches for these two-stage problems;  and their applicability and effectiveness are demonstrated by experiments based on real data. The managerial insights suggest that hospitals should improve the service equity gradually according to their financial situation because of the increasing marginal cost and should apply the scientific approaches and techniques;  rather than by their experiences;  to aid their management for better performance. By using approaches proposed in this article;  hospital managers can be equipped with a decision support tool for effective capacity allocation and patient scheduling decisions. The parameters of our models could be tuned based on the preferences of different hospitals. Furthermore;  these approaches can be applied to other settings with similar problems;  such as government budget allocation considering both utility and equity;  and service system management with waiting time requirement. 
