This article is motivated by the problem of reducing the long-term fluctuation of renewable energy and increasing the stability of microgrids. The frequent and tremendous power exchange between the microgrid and the main grid has an impact on the stability and economy of the main grid since the other plants;  such as fuel-burning generators connected to the main grid;  must quickly response. Also;  the associated cost of conservative spinning reserve and transmission line capacity would be large. Therefore;  it is of great practical interest to optimally schedule the battery energy storage system (BESS) to make the total power generated by the BESS and the wind turbine match the demand such that the long-term fluctuation of the grid power is reduced and the stability and economy of the grid are improved. In this article;  we use a Markov chain to depict the randomness of wind power and formulate the long-term fluctuation reduction problem as an Markov decision process (MDP) problem. We apply the variance of grid power to the measurement of the fluctuation and develop an iterative algorithm to obtain the optimal policy. Another challenge is the high cost of the BESS. To make a tradeoff between the economic cost and performance;  we investigate the problem of type selection and capacity sizing of the BESS. It is shown that the NaS batteries have the highest performance-cost ratio among different batteries considering the capital budget;  lifespan;  battery availability;  and performance by case study. The optimal capacity of batteries is also investigated. These results can provide insights for implementing the BESS in renewable energy systems. 
