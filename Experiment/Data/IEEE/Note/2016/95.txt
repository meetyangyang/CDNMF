Online shopping with a third-party payment platform has rapidly evolved worldwide. New security issues have arisen due to the complex interactions among APIs, which can be illegally used by malicious users. Such use often results in loss of interests of legitimate users. The issue has become more and more serious these years. This work presents a formal method to deal with such problems. It adopts a novel formal model based on Petri nets. In the conceptual design stage, given the specifications of an online shopping business process and malicious behavior patterns, it can help designers analyze whether a business process is resistant to the malicious behavior patterns. Thus, the software design can be provably secured at process design time, and the difficulty and cost to modify imperfect systems are alleviated at the system release phase. The proposed method can be readily used in the software design of industrial online shopping business processes.
